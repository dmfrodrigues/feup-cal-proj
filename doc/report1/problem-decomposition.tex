\chapter{Problem decomposition} \label{problem-decomposition}
After having formally presented the general problem, we will decompose it into successively smaller, well-known (and preferably classical) problems for each iteration, and present solutions personalized for each iteration.

\section{Iterations} \label{problem-decomposition-iterations}
\subsection{Iteration I}
The company owns one van, and thus can not leave the train station for too long. However, it must also serve the clients that are ready to travel and that are waiting for the van to start its travel.\par
The first iteration will mostly serve the purpose of testing our algorithms, therefore reducing the need for finding near-optimal heuristics for the hardest problems that will eventually be made harder in subsequent iterations.\par
We will use the path-finding algorithms described in section \ref{problem-decomposition-pathfinding} to find the shortest paths between nodes in the graph.\par
One minor heuristic we can implement to group clients is described in section \ref{algorithm-vrp-heuristic}. Having grouped clients, we now need to solve a problem similar to the \acrshort{TSP}, further described in section \ref{problem-decomposition-tsp}.
\subsection{Iteration II}
The company owns a fleet of vans, thus allowing multiple simultaneous travels to handle an increase in client demand. The system must optimize passenger grouping in vans, so as to optimize travels.\par
We will find shortest paths and handle the \acrshort{TSP} in ways similar to the previous iteration. To group clients, we will use strategies generally used to solve the \acrshort{VRP}, as described in section \ref{problem-decomposition-vrp}.
\subsection{Iteration III}
The company may also provide shuttle service for clients that might want to travel from their homes to the train station, as well as for clients without reservation.\par
To solve the first problem, we believe adding some conditions to the TSP/VRP solutions is enough, and return an infinite cost when the solution is impossible.\par
As for the second problem, priority will be given to clients with reservation, meaning a client without reservation will be assigned to one of the vans in the train station at the time of his/her arrival (or the next van that arrives to the station, in case all vans are travelling at the time that client arrives). Additionally, that client will only be accepted if it does not add more than a certain time (around $\SI{10}{min}$) to the travel that van was going to make, and if the van can still execute the posterior travels. If there is a van with no routes and that can transport that client while being able to still execute the posterior travels, then a new route is created only for that passenger.
\section{Path-finding} \label{problem-decomposition-pathfinding}
We will take advantage of the hierarchical difference between $G$ and $G'$ to make path-finding faster.\par
Since $G'$ is not too large, we can pre-calculate distances between all pairs of nodes in $G'$.
Then, all we have to do is find the two nodes on the ends of the origin's street, and the two nodes on the ends of the destination's street, and try out all the four possibilities.
\section{\texorpdfstring{\Acrlong*{TSP}}{Travelling salesman problem}} \label{problem-decomposition-tsp}
Our particular instance of the \acrshort{TSP} is very similar to the classical version. This problem is more thoroughly described in section \ref{algorithm-tsp}.
\section{\texorpdfstring{\Acrlong*{VRP}}{Vehicle routing problem}} \label{problem-decomposition-vrp}
Known strategies for the \acrshort{VRP} offer case-specific solutions taking into account the particular problem's constraints. This problem is more thoroughly described in section \ref{algorithm-vrp}.
